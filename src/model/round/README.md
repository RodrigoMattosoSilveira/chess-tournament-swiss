# round
Model a tournament round

# Model
A round is a collection of games between a tournament's players.

In a `classical tournament`, with `n` players, we have `(n-1)` rounds; there is an interesting exception where all players play each other twice, once with white and again with black pieces.

In a `match`, with two players, the number of rounds is defined by match rules, ranging from a playing a pre-defined number of games, reaching a certain number of points - in some cases draws do not count- etc.

In a `swiss pairing` tournament, the number of rounds is defined by tournament rules; in this case, the number of rounds also establishes the maximum number of players, to avoid the possibility of too many players with the top scores.

Regardless, we will focus on `swiss pairing` tournament for now.
````typescript
export interface RoundDto {
	id?: string;					// generated by the server
	tournament: string;				// required, must exist
    number: number;                 // round
	games?: Array<number>           // Ids of the round's games, []*
	state?:string; 		            // scheduled*, underway, complete
    started?: number                 // milliseconds since epoch to date (date when transioned to underway)
    ended?: number                   // milliseconds since epoch to date (date when transioned to complete)
}
````

Note that the only attribute required to create a `round` is the `tournament`. All other values are set to their defaults.
* id? - Is generated when creating a round;
* tournament - the generated tournament id;
* games - default is `[]`;
* state - default is `scheduled`;
* playedAgainst - default is `[]`;
* playedColor - default is `[]`;
* started - default is `NAN`; it is created when `round` transitions to `underway`
* state - default is `NAN`; ; it is created when `round` transitions to `complete`

## Workflow**
* The focus must be on a tournament;
* We re-factor the `tournnament` entity to have a `rounds: {round<number>: Array<string>}` attribute;
* We re-factor the `game` entity to have a `round` attribute;
* When we create a `round` entity, we add it to `tournnament.rounds[round number] = []`;
* When we assign a game to a tournament round we:
  * add the `round` to the `game.round` attribute;
  * push the `game` into `tournnament.rounds[round number]`;
* When we record a game's result:
  * if the game has a round object
    * if all other games in the round object are completed
      * then we complete the round
        * if all tournament rounds are complete
          * we complete the tournament
    
curl --location --request PATCH "localhost:3000/game/$REST_API_GAME_ID" \
--header 'Content-Type: application/json' \
--data-raw '{
    "round": "roundId"
}'
````
* finding a tournament's round's games would be tough:
  * 
#### Option 2
- Patch a round with a game (might be tricky): PATCH /round/id?add_game:id
# Removing a game
#curl
## GET ALL PLAYERS
